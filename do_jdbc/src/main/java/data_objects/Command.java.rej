*************** import java.sql.ResultSet;
*** 7,15 ****
  import java.sql.ResultSetMetaData;
  import java.sql.SQLException;
  import java.sql.Statement;
  import java.util.regex.Matcher;
  import java.util.regex.Pattern;
- import java.util.Formatter;
  
  import org.jruby.Ruby;
  import org.jruby.RubyArray;
--- 7,17 ----
  import java.sql.ResultSetMetaData;
  import java.sql.SQLException;
  import java.sql.Statement;
+ import java.util.ArrayList;
+ import java.util.Formatter;
+ import java.util.List;
  import java.util.regex.Matcher;
  import java.util.regex.Pattern;
  
  import org.jruby.Ruby;
  import org.jruby.RubyArray;
*************** import org.jruby.RubyClass;
*** 17,23 ****
  import org.jruby.RubyModule;
  import org.jruby.RubyNumeric;
  import org.jruby.RubyRange;
- import org.jruby.RubyString;
  import org.jruby.anno.JRubyClass;
  import org.jruby.anno.JRubyMethod;
  import org.jruby.exceptions.RaiseException;
--- 19,24 ----
  import org.jruby.RubyModule;
  import org.jruby.RubyNumeric;
  import org.jruby.RubyRange;
  import org.jruby.anno.JRubyClass;
  import org.jruby.anno.JRubyMethod;
  import org.jruby.exceptions.RaiseException;
*************** import org.jruby.runtime.builtin.IRubyObject;
*** 28,35 ****
  
  import data_objects.drivers.DriverDefinition;
  import data_objects.util.JDBCUtil;
- import java.util.ArrayList;
- import java.util.List;
  
  
  /**
--- 29,34 ----
  
  import data_objects.drivers.DriverDefinition;
  import data_objects.util.JDBCUtil;
  
  
  /**
*************** public class Command extends DORubyObject {
*** 265,277 ****
                  columnCount--;
  
              // pass the response to the reader
-             reader.setResultset(resultSet);
  
              // save the field count in Reader
-             reader.setFieldCount(columnCount);
  
              // get the field types
-             List<String> fieldNames = new ArrayList<String>();
  
              // If no types are passed in, infer them
              if (fieldTypes == null || fieldTypes.isEmpty()) {
--- 264,276 ----
                  columnCount--;
  
              // pass the response to the reader
+             reader.resultSet = resultSet;
  
              // save the field count in Reader
+             reader.fieldCount = columnCount;
  
              // get the field types
+             List<String> fieldNames = new ArrayList<String>(columnCount);
  
              // If no types are passed in, infer them
              if (fieldTypes == null || fieldTypes.isEmpty()) {
*************** public class Command extends DORubyObject {
*** 300,307 ****
              }
  
              // set the reader field names and types (guessed or otherwise)
-             reader.setFields(fieldNames);
-             reader.setFieldTypes(fieldTypes);
  
              // keep the statement open
  
--- 299,306 ----
              }
  
              // set the reader field names and types (guessed or otherwise)
+             reader.fieldNames = fieldNames;
+             reader.fieldTypes = fieldTypes;
  
              // keep the statement open
  
*************** public class Command extends DORubyObject {
*** 310,316 ****
              // this sets up a minimal empty reader
              if (sqle.getMessage().equals("query does not return results")) {
  
-                 reader.setResultset(resultSet);
  
                  // get the field types
                  List<String> fieldNames = new ArrayList<String>();
--- 309,315 ----
              // this sets up a minimal empty reader
              if (sqle.getMessage().equals("query does not return results")) {
  
+                 reader.resultSet = resultSet;
  
                  // get the field types
                  List<String> fieldNames = new ArrayList<String>();
*************** public class Command extends DORubyObject {
*** 332,338 ****
                  }
  
                  // set the reader field names and types (guessed or otherwise)
-                 reader.setFields(fieldNames);
                  return reader;
              }
  
--- 331,337 ----
                  }
  
                  // set the reader field names and types (guessed or otherwise)
+                 reader.fieldNames = fieldNames;
                  return reader;
              }
  
*************** public class Command extends DORubyObject {
*** 352,358 ****
      public IRubyObject set_types(IRubyObject[] args) {
          Ruby runtime = getRuntime();
          RubyArray types = RubyArray.newArray(runtime, args);
-         fieldTypes = new ArrayList<RubyType>();
  
          for (IRubyObject arg : args) {
              if (arg instanceof RubyClass) {
--- 351,357 ----
      public IRubyObject set_types(IRubyObject[] args) {
          Ruby runtime = getRuntime();
          RubyArray types = RubyArray.newArray(runtime, args);
+         fieldTypes = new ArrayList<RubyType>(types.size());
  
          for (IRubyObject arg : args) {
              if (arg instanceof RubyClass) {
